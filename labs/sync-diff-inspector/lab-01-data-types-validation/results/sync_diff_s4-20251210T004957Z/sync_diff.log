[2025/12/10 00:49:58.208 +00:00] [INFO] [printer.go:49] ["Welcome to sync_diff_inspector"] ["Release Version"=None] ["Git Commit Hash"=None] ["Git Branch"=None] ["UTC Build Time"=None] ["Go Version"=go1.24.4]
[2025/12/10 00:49:58.210 +00:00] [INFO] [main.go:102] [config="{\"check-thread-count\":4,\"split-thread-count\":5,\"export-fix-sql\":true,\"check-struct-only\":false,\"dm-addr\":\"\",\"dm-task\":\"\",\"data-sources\":{\"mysql\":{\"host\":\"127.0.0.1\",\"port\":3307,\"user\":\"root\",\"password\":\"******\",\"sql-mode\":\"\",\"snapshot\":\"\",\"sql-hint-use-index\":\"\",\"security\":null,\"route-rules\":null,\"Router\":{\"Selector\":{}},\"Conn\":null,\"session\":null},\"tidb\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"root\",\"password\":\"******\",\"sql-mode\":\"\",\"snapshot\":\"\",\"sql-hint-use-index\":\"\",\"security\":null,\"route-rules\":null,\"Router\":{\"Selector\":{}},\"Conn\":null,\"session\":null}},\"routes\":null,\"table-configs\":null,\"task\":{\"source-instances\":[\"mysql\"],\"source-routes\":null,\"target-instance\":\"tidb\",\"target-check-tables\":[\"lab.s4_mixed_app\"],\"target-configs\":null,\"output-dir\":\"/results/sync_diff_s4-20251210T004957Z\",\"SourceInstances\":[{\"host\":\"127.0.0.1\",\"port\":3307,\"user\":\"root\",\"password\":\"******\",\"sql-mode\":\"\",\"snapshot\":\"\",\"sql-hint-use-index\":\"\",\"security\":null,\"route-rules\":null,\"Router\":{\"Selector\":{}},\"Conn\":null,\"session\":null}],\"TargetInstance\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"root\",\"password\":\"******\",\"sql-mode\":\"\",\"snapshot\":\"\",\"sql-hint-use-index\":\"\",\"security\":null,\"route-rules\":null,\"Router\":{\"Selector\":{}},\"Conn\":null,\"session\":null},\"TargetTableConfigs\":null,\"TargetCheckTables\":[{}],\"FixDir\":\"/results/sync_diff_s4-20251210T004957Z/fix-on-tidb\",\"CheckpointDir\":\"/results/sync_diff_s4-20251210T004957Z/checkpoint\",\"HashFile\":\"\"},\"ConfigFile\":\"/conf/s4_tmp_20251210T004957Z.toml\",\"PrintVersion\":false}"]
[2025/12/10 00:49:58.220 +00:00] [INFO] [mysql_shard.go:393] ["will increase connection configurations for DB of instance"] ["connection limit"=10]
[2025/12/10 00:49:58.220 +00:00] [INFO] [source.go:435] ["table match check finished"]
[2025/12/10 00:49:58.220 +00:00] [INFO] [tidb.go:262] ["find router for tidb source"]
[2025/12/10 00:49:58.225 +00:00] [INFO] [source.go:435] ["table match check finished"]
[2025/12/10 00:49:58.226 +00:00] [INFO] [diff.go:386] ["The downstream is TiDB. pick it as work source first"]
[2025/12/10 00:49:58.227 +00:00] [INFO] [diff.go:221] ["not found checkpoint file, start from beginning"]
[2025/12/10 00:49:58.229 +00:00] [WARN] [utils.go:371] ["Ignoring collation differences"] ["column name"=user_name] ["collation source"=utf8mb4_0900_ai_ci] ["collation target"=utf8mb4_bin]
[2025/12/10 00:49:58.229 +00:00] [INFO] [diff.go:778] ["start writeSQLs goroutine"]
[2025/12/10 00:49:58.229 +00:00] [INFO] [diff.go:400] ["start handleCheckpoint goroutine"]
[2025/12/10 00:49:58.236 +00:00] [INFO] [tidb.go:60] ["failed to build bucket iterator, fall back to use random iterator"] [error="primary key on id in buckets info not found"] [errorVerbose="primary key on id in buckets info not found\ngithub.com/pingcap/errors.NotFoundf\n\tgithub.com/pingcap/errors@v0.11.5-0.20250523034308-74f78ae071ee/juju_adaptor.go:131\ngithub.com/pingcap/tidb/pkg/util/dbutil.GetBucketsInfo\n\tgithub.com/pingcap/tidb@v1.1.0-beta.0.20250925123346-8ea80e6b2b42/pkg/util/dbutil/common.go:529\ngithub.com/pingcap/tiflow/sync_diff_inspector/splitter.(*BucketIterator).init\n\tgithub.com/pingcap/tiflow/sync_diff_inspector/splitter/bucket.go:152\ngithub.com/pingcap/tiflow/sync_diff_inspector/splitter.NewBucketIteratorWithCheckpoint\n\tgithub.com/pingcap/tiflow/sync_diff_inspector/splitter/bucket.go:91\ngithub.com/pingcap/tiflow/sync_diff_inspector/source.(*TiDBTableAnalyzer).AnalyzeSplitter\n\tgithub.com/pingcap/tiflow/sync_diff_inspector/source/tidb.go:56\ngithub.com/pingcap/tiflow/sync_diff_inspector/source.(*ChunksIterator).produceChunks.func4\n\tgithub.com/pingcap/tiflow/sync_diff_inspector/source/chunks_iter.go:149\ngithub.com/pingcap/tiflow/sync_diff_inspector/utils.(*WorkerPool).Apply.func1\n\tgithub.com/pingcap/tiflow/sync_diff_inspector/utils/utils.go:107\nruntime.goexit\n\truntime/asm_arm64.s:1223"]
[2025/12/10 00:49:58.237 +00:00] [INFO] [random.go:167] ["get chunk size for table"] ["chunk size"=50000] [db=lab] [table=s4_mixed_app]
[2025/12/10 00:49:58.237 +00:00] [INFO] [random.go:173] ["split range by random"] ["row count"=6] ["split chunk num"=1]
[2025/12/10 00:49:58.237 +00:00] [INFO] [diff.go:310] ["global consume chunk info"] ["chunk index"="{\"table-index\":0,\"bucket-index-left\":0,\"bucket-index-right\":0,\"chunk-index\":0,\"chunk-count\":1}"] ["chunk bound"="[]"]
[2025/12/10 00:49:58.240 +00:00] [WARN] [utils.go:631] ["find different row"] [column=created_at] [row1="{ settings: {\"lang\": \"en\", \"theme\": \"dark\"}, flags: \ufffd, description: Regular user, binary_data: \ufffd\ufffd, created_at: 2025-12-10 00:49:51, id: 1, user_name: alice, profile_blob: Profile data for Alice,  }"] [row2="{ settings: {\"lang\": \"en\", \"theme\": \"dark\"}, flags: \ufffd, description: Regular user, binary_data: \ufffd\ufffd, created_at: 2025-12-10 00:49:53, id: 1, user_name: alice, profile_blob: Profile data for Alice,  }"]
[2025/12/10 00:49:58.240 +00:00] [WARN] [utils.go:631] ["find different row"] [column=created_at] [row1="{ id: 2, user_name: bob, profile_blob: Profile data for Bob, settings: {\"lang\": \"zh\", \"theme\": \"light\"}, flags: U, description: Power user, binary_data: \u00124, created_at: 2025-12-10 00:49:51,  }"] [row2="{ flags: U, description: Power user, binary_data: \u00124, created_at: 2025-12-10 00:49:53, id: 2, user_name: bob, profile_blob: Profile data for Bob, settings: {\"lang\": \"zh\", \"theme\": \"light\"},  }"]
[2025/12/10 00:49:58.240 +00:00] [WARN] [utils.go:631] ["find different row"] [column=created_at] [row1="{ flags: \ufffd, description: Admin user, binary_data: IsNull, created_at: 2025-12-10 00:49:51, id: 3, user_name: charlie, profile_blob: IsNull, settings: {\"email\": \"c@example.com\", \"notifications\": true},  }"] [row2="{ id: 3, user_name: charlie, profile_blob: IsNull, settings: {\"email\": \"c@example.com\", \"notifications\": true}, flags: \ufffd, description: Admin user, binary_data: IsNull, created_at: 2025-12-10 00:49:53,  }"]
[2025/12/10 00:49:58.240 +00:00] [WARN] [utils.go:631] ["find different row"] [column=user_name] [row1="{ settings: {\"ä¸­æ–‡\": \"æ”¯æŒ\", \"æ•°ç»„\": [1, 2, 3]}, flags: \u000f, description: UTF-8 test, binary_data: 测试, created_at: 2025-12-10 00:49:51, id: 4, user_name: æµ‹è¯•ç”¨æˆ·, profile_blob: 测试数据,  }"] [row2="{ created_at: 2025-12-10 00:49:53, id: 4, user_name: 测试用户, profile_blob: 测试数据, settings: {\"中文\": \"支持\", \"数组\": [1, 2, 3]}, flags: \u000f, description: UTF-8 test, binary_data: 测试,  }"]
[2025/12/10 00:49:58.241 +00:00] [WARN] [utils.go:631] ["find different row"] [column=created_at] [row1="{ profile_blob: , settings: {}, flags: \u0000, description: , binary_data: , created_at: 2025-12-10 00:49:51, id: 5, user_name: empty_user,  }"] [row2="{ binary_data: , created_at: 2025-12-10 00:49:53, id: 5, user_name: empty_user, profile_blob: , settings: {}, flags: \u0000, description: ,  }"]
[2025/12/10 00:49:58.241 +00:00] [WARN] [utils.go:631] ["find different row"] [column=created_at] [row1="{ id: 6, user_name: IsNull, profile_blob: IsNull, settings: IsNull, flags: IsNull, description: IsNull, binary_data: IsNull, created_at: 2025-12-10 00:49:51,  }"] [row2="{ created_at: 2025-12-10 00:49:53, id: 6, user_name: IsNull, profile_blob: IsNull, settings: IsNull, flags: IsNull, description: IsNull, binary_data: IsNull,  }"]
[2025/12/10 00:49:58.243 +00:00] [INFO] [diff.go:789] ["write sql channel closed"]
[2025/12/10 00:49:58.243 +00:00] [INFO] [diff.go:780] ["close writeSQLs goroutine"]
[2025/12/10 00:49:58.243 +00:00] [INFO] [diff.go:428] ["Stop do checkpoint"]
[2025/12/10 00:49:58.244 +00:00] [INFO] [checkpoints.go:255] ["save checkpoint"] [chunk="{\"state\":\"failed\",\"chunk-range\":{\"index\":{\"table-index\":0,\"bucket-index-left\":0,\"bucket-index-right\":0,\"chunk-index\":0,\"chunk-count\":1},\"type\":2,\"bounds\":[],\"is-first\":false,\"is-last\":false,\"where\":\"((TRUE) AND (TRUE))\",\"args\":null,\"index-column-names\":[{\"O\":\"id\",\"L\":\"id\"}]},\"index-id\":0}"] [state=failed]
[2025/12/10 00:49:58.245 +00:00] [INFO] [diff.go:402] ["close handleCheckpoint goroutine"]
[2025/12/10 00:49:58.246 +00:00] [WARN] [report.go:165] ["fail to get the correct size of table, if you want to get the correct size, please analyze the corresponding tables"] [table=`lab`.`s4_mixed_app`] []
[2025/12/10 00:49:58.248 +00:00] [INFO] [main.go:115] ["check data finished"] [cost=37.351793ms]
[2025/12/10 00:49:58.248 +00:00] [WARN] [main.go:106] ["check failed!!!"]

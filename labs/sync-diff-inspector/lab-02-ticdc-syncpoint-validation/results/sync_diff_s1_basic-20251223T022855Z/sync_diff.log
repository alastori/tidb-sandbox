[2025/12/22 21:28:56.269 -05:00] [INFO] [printer.go:49] ["Welcome to sync_diff_inspector"] ["Release Version"=None] ["Git Commit Hash"=None] ["Git Branch"=None] ["UTC Build Time"=None] ["Go Version"=go1.23.4]
[2025/12/22 21:28:56.269 -05:00] [INFO] [main.go:102] [config="{\"check-thread-count\":4,\"split-thread-count\":5,\"export-fix-sql\":true,\"check-struct-only\":false,\"dm-addr\":\"\",\"dm-task\":\"\",\"data-sources\":{\"downstream\":{\"host\":\"127.0.0.1\",\"port\":14000,\"user\":\"root\",\"password\":\"******\",\"sql-mode\":\"\",\"snapshot\":\"auto\",\"security\":null,\"route-rules\":null,\"Router\":{\"Selector\":{}},\"Conn\":null},\"upstream\":{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"root\",\"password\":\"******\",\"sql-mode\":\"\",\"snapshot\":\"auto\",\"security\":null,\"route-rules\":null,\"Router\":{\"Selector\":{}},\"Conn\":null}},\"routes\":null,\"table-configs\":null,\"task\":{\"source-instances\":[\"upstream\"],\"source-routes\":null,\"target-instance\":\"downstream\",\"target-check-tables\":[\"syncpoint_lab.t1\"],\"target-configs\":null,\"output-dir\":\"/Users/alastori/Library/Mobile Documents/com~apple~CloudDocs/Sandbox/tidb-sandbox/labs/sync-diff-inspector/lab-02-ticdc-syncpoint-validation/results/sync_diff_s1_basic-20251223T022855Z\",\"SourceInstances\":[{\"host\":\"127.0.0.1\",\"port\":4000,\"user\":\"root\",\"password\":\"******\",\"sql-mode\":\"\",\"snapshot\":\"auto\",\"security\":null,\"route-rules\":null,\"Router\":{\"Selector\":{}},\"Conn\":null}],\"TargetInstance\":{\"host\":\"127.0.0.1\",\"port\":14000,\"user\":\"root\",\"password\":\"******\",\"sql-mode\":\"\",\"snapshot\":\"auto\",\"security\":null,\"route-rules\":null,\"Router\":{\"Selector\":{}},\"Conn\":null},\"TargetTableConfigs\":null,\"TargetCheckTables\":[{}],\"FixDir\":\"/Users/alastori/Library/Mobile Documents/com~apple~CloudDocs/Sandbox/tidb-sandbox/labs/sync-diff-inspector/lab-02-ticdc-syncpoint-validation/results/sync_diff_s1_basic-20251223T022855Z/fix-on-downstream\",\"CheckpointDir\":\"/Users/alastori/Library/Mobile Documents/com~apple~CloudDocs/Sandbox/tidb-sandbox/labs/sync-diff-inspector/lab-02-ticdc-syncpoint-validation/results/sync_diff_s1_basic-20251223T022855Z/checkpoint\",\"HashFile\":\"\"},\"ConfigFile\":\"/Users/alastori/Library/Mobile Documents/com~apple~CloudDocs/Sandbox/tidb-sandbox/labs/sync-diff-inspector/lab-02-ticdc-syncpoint-validation/conf/s1_basic_tmp_20251223T022855Z.toml\",\"PrintVersion\":false}"]
[2025/12/22 21:28:56.272 -05:00] [INFO] [config.go:194] ["create connection with snapshot"] [snapshot=463066080328548384]
[2025/12/22 21:28:56.273 -05:00] [INFO] [config.go:194] ["create connection with snapshot"] [snapshot=463066080215040000]
[2025/12/22 21:28:56.278 -05:00] [INFO] [tidb.go:236] ["find router for tidb source"]
[2025/12/22 21:28:56.280 -05:00] [INFO] [source.go:425] ["table match check finished"]
[2025/12/22 21:28:56.280 -05:00] [INFO] [tidb.go:236] ["find router for tidb source"]
[2025/12/22 21:28:56.282 -05:00] [INFO] [source.go:425] ["table match check finished"]
[2025/12/22 21:28:56.282 -05:00] [INFO] [diff.go:381] ["The upstream is TiDB. pick it as work source candidate"]
[2025/12/22 21:28:56.287 -05:00] [INFO] [pd_service_discovery.go:1025] ["[pd] switch leader"] [new-leader=http://127.0.0.1:2379] [old-leader=]
[2025/12/22 21:28:56.287 -05:00] [INFO] [pd_service_discovery.go:499] ["[pd] init cluster id"] [cluster-id=7586874517039048810]
[2025/12/22 21:28:56.287 -05:00] [INFO] [client.go:532] ["[pd] changing service mode"] [old-mode=UNKNOWN_SVC_MODE] [new-mode=PD_SVC_MODE]
[2025/12/22 21:28:56.287 -05:00] [INFO] [tso_client.go:296] ["[tso] switch dc tso global allocator serving url"] [dc-location=global] [new-url=http://127.0.0.1:2379]
[2025/12/22 21:28:56.288 -05:00] [INFO] [client.go:538] ["[pd] service mode changed"] [old-mode=UNKNOWN_SVC_MODE] [new-mode=PD_SVC_MODE]
[2025/12/22 21:28:56.288 -05:00] [INFO] [tso_dispatcher.go:140] ["[tso] start tso deadline watcher"] [dc-location=global]
[2025/12/22 21:28:56.288 -05:00] [INFO] [tso_dispatcher.go:198] ["[tso] tso dispatcher created"] [dc-location=global]
[2025/12/22 21:28:56.288 -05:00] [INFO] [tso_client.go:132] ["[tso] start tso dispatcher check loop"]
[2025/12/22 21:28:56.288 -05:00] [INFO] [tso_dispatcher.go:476] ["[tso] start tso connection contexts updater"] [dc-location=global]
[2025/12/22 21:28:56.288 -05:00] [INFO] [tso_dispatcher.go:723] ["[tso] switching tso rpc concurrency"] [old=0] [new=1]
[2025/12/22 21:28:56.288 -05:00] [INFO] [pd.go:213] ["tidb support auto gc safepoint"] [version=8.5.1]
[2025/12/22 21:28:56.288 -05:00] [INFO] [diff.go:372] ["start update service to keep GC stopped automatically"]
[2025/12/22 21:28:56.288 -05:00] [INFO] [pd.go:228] ["generate dumpling gc safePoint id"] [id=Sync_diff_1766456936288464000]
[2025/12/22 21:28:56.288 -05:00] [INFO] [diff.go:386] ["The downstream is TiDB. pick it as work source first"]
[2025/12/22 21:28:56.294 -05:00] [INFO] [pd_service_discovery.go:1025] ["[pd] switch leader"] [new-leader=http://127.0.0.1:12379] [old-leader=]
[2025/12/22 21:28:56.294 -05:00] [INFO] [pd_service_discovery.go:499] ["[pd] init cluster id"] [cluster-id=7586874522707856235]
[2025/12/22 21:28:56.294 -05:00] [INFO] [client.go:532] ["[pd] changing service mode"] [old-mode=UNKNOWN_SVC_MODE] [new-mode=PD_SVC_MODE]
[2025/12/22 21:28:56.294 -05:00] [INFO] [tso_client.go:296] ["[tso] switch dc tso global allocator serving url"] [dc-location=global] [new-url=http://127.0.0.1:12379]
[2025/12/22 21:28:56.294 -05:00] [INFO] [client.go:538] ["[pd] service mode changed"] [old-mode=UNKNOWN_SVC_MODE] [new-mode=PD_SVC_MODE]
[2025/12/22 21:28:56.294 -05:00] [INFO] [tso_dispatcher.go:140] ["[tso] start tso deadline watcher"] [dc-location=global]
[2025/12/22 21:28:56.294 -05:00] [INFO] [tso_dispatcher.go:198] ["[tso] tso dispatcher created"] [dc-location=global]
[2025/12/22 21:28:56.294 -05:00] [INFO] [tso_client.go:132] ["[tso] start tso dispatcher check loop"]
[2025/12/22 21:28:56.294 -05:00] [INFO] [tso_dispatcher.go:723] ["[tso] switching tso rpc concurrency"] [old=0] [new=1]
[2025/12/22 21:28:56.294 -05:00] [INFO] [tso_dispatcher.go:476] ["[tso] start tso connection contexts updater"] [dc-location=global]
[2025/12/22 21:28:56.294 -05:00] [INFO] [pd.go:213] ["tidb support auto gc safepoint"] [version=8.5.1]
[2025/12/22 21:28:56.294 -05:00] [INFO] [diff.go:372] ["start update service to keep GC stopped automatically"]
[2025/12/22 21:28:56.294 -05:00] [INFO] [pd.go:228] ["generate dumpling gc safePoint id"] [id=Sync_diff_1766456936294863000]
[2025/12/22 21:28:56.294 -05:00] [INFO] [diff.go:221] ["not found checkpoint file, start from beginning"]
[2025/12/22 21:28:56.296 -05:00] [INFO] [diff.go:778] ["start writeSQLs goroutine"]
[2025/12/22 21:28:56.296 -05:00] [INFO] [diff.go:400] ["start handleCheckpoint goroutine"]
[2025/12/22 21:28:56.304 -05:00] [INFO] [tidb.go:59] ["failed to build bucket iterator, fall back to use random iterator"] [error="primary key on id in buckets info not found"] [errorVerbose="primary key on id in buckets info not found\ngithub.com/pingcap/errors.NotFoundf\n\tgithub.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/juju_adaptor.go:126\ngithub.com/pingcap/tidb/pkg/util/dbutil.GetBucketsInfo\n\tgithub.com/pingcap/tidb@v1.1.0-beta.0.20241223052309-3735ed55a394/pkg/util/dbutil/common.go:529\ngithub.com/pingcap/tiflow/sync_diff_inspector/splitter.(*BucketIterator).init\n\tgithub.com/pingcap/tiflow/sync_diff_inspector/splitter/bucket.go:152\ngithub.com/pingcap/tiflow/sync_diff_inspector/splitter.NewBucketIteratorWithCheckpoint\n\tgithub.com/pingcap/tiflow/sync_diff_inspector/splitter/bucket.go:91\ngithub.com/pingcap/tiflow/sync_diff_inspector/source.(*TiDBTableAnalyzer).AnalyzeSplitter\n\tgithub.com/pingcap/tiflow/sync_diff_inspector/source/tidb.go:55\ngithub.com/pingcap/tiflow/sync_diff_inspector/source.(*ChunksIterator).produceChunks.func3\n\tgithub.com/pingcap/tiflow/sync_diff_inspector/source/chunks_iter.go:140\ngithub.com/pingcap/tiflow/sync_diff_inspector/utils.(*WorkerPool).Apply.func1\n\tgithub.com/pingcap/tiflow/sync_diff_inspector/utils/utils.go:106\nruntime.goexit\n\truntime/asm_arm64.s:1223"]
[2025/12/22 21:28:56.305 -05:00] [INFO] [random.go:119] ["get chunk size for table"] ["chunk size"=50000] [db=syncpoint_lab] [table=t1]
[2025/12/22 21:28:56.305 -05:00] [INFO] [random.go:125] ["split range by random"] ["row count"=5] ["split chunk num"=1]
[2025/12/22 21:28:56.305 -05:00] [INFO] [diff.go:310] ["global consume chunk info"] ["chunk index"="{\"table-index\":0,\"bucket-index-left\":0,\"bucket-index-right\":0,\"chunk-index\":0,\"chunk-count\":1}"] ["chunk bound"="[]"]
[2025/12/22 21:28:56.306 -05:00] [INFO] [diff.go:789] ["write sql channel closed"]
[2025/12/22 21:28:56.309 -05:00] [INFO] [diff.go:780] ["close writeSQLs goroutine"]
[2025/12/22 21:28:56.309 -05:00] [INFO] [diff.go:428] ["Stop do checkpoint"]
[2025/12/22 21:28:56.310 -05:00] [INFO] [checkpoints.go:255] ["save checkpoint"] [chunk="{\"state\":\"success\",\"chunk-range\":{\"index\":{\"table-index\":0,\"bucket-index-left\":0,\"bucket-index-right\":0,\"chunk-index\":0,\"chunk-count\":1},\"type\":2,\"bounds\":[],\"is-first\":false,\"is-last\":false,\"where\":\"((TRUE) AND (TRUE))\",\"args\":null},\"index-id\":0}"] [state=success]
[2025/12/22 21:28:56.310 -05:00] [INFO] [diff.go:402] ["close handleCheckpoint goroutine"]
[2025/12/22 21:28:56.311 -05:00] [WARN] [report.go:165] ["fail to get the correct size of table, if you want to get the correct size, please analyze the corresponding tables"] [table=`syncpoint_lab`.`t1`] []
[2025/12/22 21:28:56.312 -05:00] [INFO] [main.go:115] ["check data finished"] [cost=42.249875ms]
[2025/12/22 21:28:56.312 -05:00] [INFO] [main.go:109] ["check pass!!!"]
